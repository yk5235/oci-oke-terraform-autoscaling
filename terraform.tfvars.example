# ============================================
# TERRAFORM VARIABLES - AUTOSCALING WORKSHOP
# CORRECTED VERSION - Matches variables.tf structure
# ============================================

# ============================================
# REQUIRED CONFIGURATION
# ============================================

region         = "ap-singapore-1"
compartment_id = "ocid1.compartment.oc1..your-compartment-ocid-here"
ssh_public_key = "ssh-rsa AAAAB3NzaC1yc2EAAA... your-public-key-here"

# ============================================
# NETWORK CONFIGURATION
# ============================================

vcn_cidr                = "10.0.0.0/16"
vcn_display_name        = "oke-autoscaling-vcn"
vcn_dns_label           = "okeautoscale"

# Public/Private Configuration
kubapi_subnet_is_public = false  # Private API (use bastion)
lb_subnet_is_public     = true   # Public load balancers

# ============================================
# OKE CLUSTER CONFIGURATION
# ============================================

cluster_name                    = "oke-autoscale"
kubernetes_version              = "v1.33.1"
cluster_type                    = "ENHANCED_CLUSTER"
cni_type                        = "OCI_VCN_IP_NATIVE"
is_kubernetes_dashboard_enabled = false

# ============================================
# NODE POOL CONFIGURATION (for autoscaling)
# ============================================

node_shape                                = "VM.Standard.E4.Flex"
node_pool_node_shape_config_ocpus         = 2
node_pool_node_shape_config_memory_in_gbs = 16
boot_volume_size_in_gbs                   = 50
max_pods_per_node                         = 31

# ============================================
# AUTOSCALING CONFIGURATION
# ============================================

enable_autoscaling                       = true
initial_node_count                       = 1
min_node_count                           = 1
max_node_count                           = 5
eviction_grace_duration                  = "PT1H"
is_force_delete_after_grace_duration     = false

# ============================================
# BASTION CONFIGURATION
# CORRECT VARIABLE NAMES (matches variables.tf)
# ============================================

enable_bastion           = true
create_bastion_subnet    = true
bastion_subnet_cidr      = "10.0.3.0/28"
bastion_allowed_ssh_cidr = "0.0.0.0/0"
bastion_display_name     = "oke-bastion"
bastion_shape            = "VM.Standard.E4.Flex"

# IMPORTANT: bastion_shape_config is an OBJECT, not individual variables
bastion_shape_config = {
  ocpus         = 1
  memory_in_gbs = 4
}

bastion_boot_volume_size = 50

# ============================================
# TOOL VERSIONS
# ============================================

docker_version  = "latest"
kubectl_version = "latest"
oci_cli_version = "latest"
helm_version    = "latest"

# ============================================
# INTEGRATION OPTIONS
# ============================================

bastion_setup_kubeconfig     = true
bastion_wait_for_cloud_init  = false
tenancy_namespace            = ""  # Add your tenancy namespace if needed

# ============================================
# ENVIRONMENT & TAGS
# ============================================

environment = "dev"

tags = {
  "ManagedBy" = "Terraform"
  "Project"   = "OKE-Autoscaling-Workshop"
}

# ============================================
# NOTES
# ============================================

# Key differences from previous version:
# 1. bastion_ocpus          -> bastion_shape_config.ocpus
# 2. bastion_memory_in_gbs  -> bastion_shape_config.memory_in_gbs  
# 3. bastion_boot_volume_size_in_gbs -> bastion_boot_volume_size

# To disable bastion temporarily:
# enable_bastion = false

# To make API public (skip bastion):
# kubapi_subnet_is_public = true
# enable_bastion = false
